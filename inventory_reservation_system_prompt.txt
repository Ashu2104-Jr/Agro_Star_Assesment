FULL PROMPT: Inventory Stock Reservation System

Problem Title: Inventory Stock Reservation System

Problem Statement: Design and implement an Inventory Stock Reservation
System that manages product inventory, allows temporary stock
reservations for orders, handles automatic expiry of reservations, and
ensures expired reservations do not block stock availability.

The system must be concurrency-safe, scalable, and time-based without
using continuously running timers.

Core Requirements: - Maintain product stock - Allow stock reservation
for an order - Reservation expires after X minutes - If reservation
expires, stock must be released - Confirm order to finalize stock -
Provide available stock to users

Key Condition: Expired reservations must not block stock.

Design Constraints & Logic: - No continuously running timers - Use
expires_at timestamp for reservations - Expiry checked only on actions
(reserve, confirm, cleanup job) - Browsing/GET APIs must not update
stock - Stock accuracy enforced at checkout - Optimistic locking using
version field

Tech Stack: - Java - Spring Boot - MySQL - Spring Data JPA / Hibernate

Project Structure: controller/ service/ repository/ dto/ entity/ config/

Database Design: Product, Inventory (with version), Reservation, Order
tables

APIs: - Add/Update Product Stock - Reserve Stock - Confirm Order - Get
Available Stock

Concurrency: Use optimistic locking on inventory with version column.

Reservation Lifecycle: RESERVED -> CONFIRMED RESERVED -> EXPIRED ->
STOCK RELEASED

Guiding Principle: Time does not trigger actions. Actions trigger time
checks.
